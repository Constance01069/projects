"0","modlin <- function(X) apply(X, 1, sum) # Linear model"
"0","mu <- rep(0, 3) # Mean vector"
"0","sig <- c(1, 1, 2) # Variance vector"
"0","ro <- 0.9 # correlation coefficient (between X2 and X3)"
"0","Cormat <- matrix(c(1,0,0,0,1,ro,0,ro,1),3,3) # Correlation matrix"
"0","Covmat <- ( sig %*% t(sig) ) * Cormat # Covariance matrix"
"0","set.seed(12345) # To reproduce the same results"
"0","n <- 1e4"
"0","library(mvtnorm) # Multivariate Gaussian variables"
"0","Xall <- function(n) rmvnorm(n, mu, Covmat) # Sampling function"
"0",""
"0","X1 <- data.frame(Xall(n)) ; X2 <- data.frame(Xall(n))"
"0","library(sensitivity)"
"0","sa <- sobol(modlin, X1=X1, X2=X2, order=list(1,2:3), nboot=100)"
"0","print(sa$V[-1,]/sa$V[1,1]) # Divide by variance to get Sobol'"
